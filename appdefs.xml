<!--
Definitions for CloudBerry Backup docker container.

This file is used as data source to generate README.md and unRAID template files
from Jinja2 templates.
-->
<defs>
  <app>
    <id>2</id>
    <gui_type>x11</gui_type>
    <friendly_name>CloudBerry Backup</friendly_name>
    <name>{{ defs.app.friendly_name|lower|replace(' ', '-') }}</name>
    <project>
      <description>Backup files and folders to cloud storage of your choice: Amazon S3, Azure Blob Storage, Google Cloud Storage, HP Cloud, Rackspace Cloud Files, OpenStack, DreamObjects and other.</description>
      <url>https://www.cloudberrylab.com/backup/linux.aspx</url>
    </project>
    <unraid>
      <support_url>https://forums.unraid.net/topic/57217-support-cloudberry-backup/</support_url>
      <category>Backup:</category>
    </unraid>
    <container>
      <rough_download_size>60MB</rough_download_size>
      <storage_permissions>ro</storage_permissions>
    </container>
    <!-- Extra stuff to be added to the documentation. -->
    <documentation>
      <section>
        <title level="2">CloudBerry Backup Web Interface</title>
        <content>
CloudBerry Backup provides its own web interface.  It can be accessed via HTTP
port 43210 and/or HTTPs port 43211.
        </content>
      </section>
      <section>
        <title level="3">Credentials</title>
        <content>
A username and password must be configured before being able to login to the web interface.

The username is set via the `CBB_WEB_INTERFACE_USER` environment variable.

There are two ways of setting the password:
  - Via the `CBB_WEB_INTERFACE_PASSWORD` environment variable.
  - By storing the password hash in `/config/.cbb_web_interface_pass_hash`
    (container path).

The password hash can be generated by the command `mkpasswd`.  For example, to
generate the hash using the SHA-512 method:
```
mkpasswd -m sha-512
```

The whole output of the command must be saved into
`/config/.cbb_web_interface_pass_hash`.  Here is an example of the output:
```
$6$VkhGUiCpmE$Mqm8k4oBKF0O4gqstzUvq32FJ3nxgAMjyhqbESCPj8nqSvcQoZw4d/U.oQYN/rsh4FonIoPjsvOn/WQSG84RE/
```

An other way of generating the password hash is to set the password in
clear-text in `/config/.cbb_web_interface_clear_text_pass`.  When the container
starts, a hash is performed using the content of this file and is automatically
saved to `/config/.cbb_web_interface_pass_hash`.  Then, the clear-text password
file is deleted.
        </content>
      </section>
    </documentation>
    <!-- Changelog of the application. -->
    <history>
      <release>
        <version>1.20.3</version>
        <date>2019-08-27</date>
        <change>Upgraded CloudBerry Backup to version 2.9.4.12.</change>
      </release>
      <release>
        <version>1.20.2</version>
        <date>2019-08-16</date>
        <change>Upgraded CloudBerry Backup to version 2.9.3.15.</change>
      </release>
      <release>
        <version>1.20.1</version>
        <date>2019-07-31</date>
        <change>Upgraded CloudBerry Backup to version 2.9.2.14.</change>
      </release>
      <release>
        <version>1.20.0</version>
        <date>2019-07-05</date>
        <change>Upgraded CloudBerry Backup to version 2.9.1.16.</change>
      </release>
      <release>
        <version>1.19.0</version>
        <date>2019-05-17</date>
        <change>Upgraded CloudBerry Backup to version 2.9.0.114.</change>
      </release>
      <release>
        <version>1.18.1</version>
        <date>2019-04-24</date>
        <change>Now using baseimage v3.5.2, which brings the following changes:</change>
        <change level="2">Updated installed packages to get latest security fixes.</change>
        <change level="2">Fixed issue where the container could have a zombie process.</change>
        <change level="2">Fixed issue where the password would not be submitted when pressing the enter key in the password modal.</change>
        <change level="2">Use relative path for favicon ressources to be more friendly with reverse proxy senarios.</change>
      </release>
      <release>
        <version>1.18.0</version>
        <date>2019-04-05</date>
        <change>Upgraded CloudBerry Backup to version 2.8.3.10.</change>
      </release>
      <release>
        <version>1.17.0</version>
        <date>2019-03-07</date>
        <change>Upgraded CloudBerry to version 2.8.1.14.</change>
      </release>
      <release>
        <version>1.16.0</version>
        <date>2019-02-27</date>
        <change>Upgraded CloudBerry Backup to version 2.8.0.35.</change>
        <change>Make sure to start the UI only when the management service is ready.</change>
      </release>
      <release>
        <version>1.15.0</version>
        <date>2018-10-02</date>
        <change>Upgraded CloudBerry Backup to version 2.6.0.31.</change>
      </release>
      <release>
        <version>1.14.1</version>
        <date>2018-09-18</date>
        <change>Now using baseimage v3.5.1, which brings the following changes:</change>
        <change level="2">Updated installed packages to get latest security fixes.</change>
      </release>
      <release>
        <version>1.14.0</version>
        <date>2018-09-06</date>
        <change>Upgraded CloudBerry Backup to version 2.5.1.26.</change>
      </release>
      <release>
        <version>1.13.1</version>
        <date>2018-08-08</date>
        <change>Upgraded CloudBerry Backup to version 2.5.0.39.</change>
      </release>
      <release>
        <version>1.13.0</version>
        <date>2018-07-17</date>
        <change>Upgraded CloudBerry Backup to version 2.5.0.32.</change>
        <change>Now using baseimage v3.4.0, which is based on Alpine Linux 3.8.</change>
      </release>
      <release>
        <version>1.12.3</version>
        <date>2018-06-08</date>
        <change>Upgraded CloudBerry Backup to version 2.4.3.11.</change>
      </release>
      <release>
        <version>1.12.2</version>
        <date>2018-05-16</date>
        <change>Upgraded CloudBerry Backup to version 2.4.2.4.</change>
      </release>
      <release>
        <version>1.12.1</version>
        <date>2018-04-07</date>
        <change>Upgraded CloudBerry Backup to version 2.4.1.6.</change>
      </release>
      <release>
        <version>1.12.0</version>
        <date>2018-03-27</date>
        <change>Updapted CloudBerry Backup to version 2.4.0.17.</change>
        <change>Switched to a baseimage based on Alpine Linux 3.7.</change>
      </release>
      <release>
        <version>1.11.3</version>
        <date>2018-03-02</date>
        <change>Now using baseimage v3.3.4, which brings the following changes (since last used version):</change>
        <change level="2">Make sure the log monitor is started after the X server.</change>
        <change level="2">Fixed an issue where the log monitor `yad` target would use XDG folders of the application.</change>
        <change level="2">Fixed issue where log monitor states were not cleared during container startup.</change>
      </release>
      <release>
        <version>1.11.2</version>
        <date>2018-02-03</date>
        <change>Now using baseimage v3.3.2, which brings the following changes:</change>
        <change level="2">Restored timezone support in Alpine Linux images with glibc.</change>
        <change level="2">Fixed issue in `add-pkg` helper where a package could be incorrectly detected as installed.</change>
      </release>
      <release>
        <version>1.11.1</version>
        <date>2018-01-30</date>
        <change>Now using baseimage v3.3.1, which brings the following changes:</change>
        <change level="2">Adjusted the way some ressources are accessed to better support reverse proxy to the container.</change>
      </release>
      <release>
        <version>1.11.0</version>
        <date>2018-01-26</date>
        <change>Upgraded CloudBerry Backup to version 2.3.0.12.</change>
      </release>
      <release>
        <version>1.10.0</version>
        <date>2018-01-22</date>
        <change>Now using baseimage v3.3.0, which brings the following changes (since last used version):</change>
        <change level="2">For Alpine Linux images with glibc, automatically update dynamic linker's cache after new libraries are installed.</change>
        <change level="2">Fixed the LANG environment variable not being set properly.</change>
        <change level="2">Added the ability to automatically install a CJK (Chinese/Japanese/Korean) font.</change>
        <change>Upgraded CloudBerry Backup to version 2.2.1.9.</change>
      </release>
      <release>
        <version>1.9.3</version>
        <date>2018-01-11</date>
        <change>Fixed issue where libraries were not found.</change>
      </release>
      <release>
        <version>1.9.2</version>
        <date>2018-01-11</date>
        <change>Now using baseimage v3.2.2, which brings the following changes (since last used version):</change>
        <change level="2">Upgraded S6 overlay to version 1.21.2.2.</change>
        <change level="2">Upgraded glibc to version 2.26 (Alpine Linux glibc images).</change>
        <change level="2">Adjusted the way ownership of /config is taken to better support cases where the folder is mapped to a network share.</change>
        <change>Small adjustment to the way ownership of files are taken.</change>
      </release>
      <release>
        <version>1.9.1</version>
        <date>2017-12-12</date>
        <change>Now using baseimage v3.1.4, which brings the following changes:</change>
        <change level="2">Set 2 worker processes for nginx.</change>
      </release>
      <release>
        <version>1.9.0</version>
        <date>2017-12-04</date>
        <change>Upgraded CloudBerry Backup to version 2.2.0.76.</change>
      </release>
      <release>
        <version>1.8.2</version>
        <date>2017-11-20</date>
        <change>Now using baseimage v3.1.3, which brings the following changes:</change>
        <change level="2">Upgraded S6 overlay to version 1.21.2.1.</change>
      </release>
      <release>
        <version>1.8.1</version>
        <date>2017-11-07</date>
        <change>Now using baseimage v3.1.2, which brings the following changes (from last used version):</change>
        <change level="2">Fixed an issue where a self-disabled service could be restarted.</change>
        <change level="2">Upgraded S6 overlay to version 1.21.2.0.</change>
        <change level="2">Use a more efficient way to monitor status files.</change>
      </release>
      <release>
        <version>1.8.0</version>
        <date>2017-10-29</date>
        <change>Now using baseimage v3.1.0, which brings the following changes:</change>
        <change level="2">Upgraded S6 overlay to version 1.21.1.1.</change>
        <change level="2">Enhanced integration of service dependencies functionality.</change>
        <change level="2">Added a simple log monitor.</change>
        <change level="2">Fixed race condition where container's exit code would not be the expected one.</change>
        <change level="2">Fixed issue where application's GUI fails to displayed when accessing it through the web interface via standard ports 80/443.</change>
      </release>
      <release>
        <version>1.7.0</version>
        <date>2017-10-09</date>
        <change>Now using baseimage v3.0.2, which brings the following changes:</change>
        <change level="2">Better support for service dependencies.</change>
        <change level="2">Added support for secure access to the application's GUI.</change>
      </release>
      <release>
        <version>1.6.0</version>
        <date>2017-09-20</date>
        <change>Now using baseimage v2.0.9, which brings the following changes:</change>
        <change level="2">Restore default `/etc/shadow` during container startup.</change>
        <change>Upgraded CloudBerry Backup to version 2.1.0.81.</change>
        <change>Added support for the new CloudBerry Backup native web interface.</change>
      </release>
      <release>
        <version>1.5.8</version>
        <date>2017-09-08</date>
        <change>Now using baseimage v2.0.8, which brings the following changes:</change>
        <change level="2">Fixed duplicated entries in /etc/passwd and /etc/group that were created after a restart of the container.</change>
        <change>Upgraded CloudBerry Backup to version 2.0.3.30.</change>
      </release>
      <release>
        <version>1.5.7</version>
        <date>2017-09-06</date>
        <change>Now using baseimage v2.0.7, which brings the following changes:</change>
        <change level="2">Fixed timezone support on alpine-glibc images.</change>
        <change>Upgraded CloudBerry Backup to version 2.0.3.26.</change>
        <change>Minor fix in displayed app title.</change>
      </release>
      <release>
        <version>1.5.6</version>
        <date>2017-08-28</date>
        <change>Upgraded CloudBerry Backup to version 2.0.3.25.</change>
      </release>
      <release>
        <version>1.5.5</version>
        <date>2017-08-14</date>
        <change>Now using baseimage v2.0.6, which brings the following changes:</change>
        <change level="2">Upgraded S6 overlay to version 1.20.0.0.</change>
      </release>
      <release>
        <version>1.5.4</version>
        <date>2017-07-31</date>
        <change>Now using baseimage v2.0.5, which brings the following changes (from last used version):</change>
        <change level="2">Clear the environment of the container during startup.</change>
        <change level="2">Clear the /tmp folder during startup.</change>
        <change level="2">Cleanly terminate the X server when container is restarted/stopped.</change>
        <change level="2">Improved robustness of X server starting process.</change>
        <change level="2">Removed unneeded files from the image.</change>
      </release>
      <release>
        <version>1.5.3</version>
        <date>2017-07-27</date>
        <change>Now using baseimage v2.0.3, which brings the following changes:</change>
        <change level="2">Improved robustness of the X server starting process.</change>
      </release>
      <release>
        <version>1.5.2</version>
        <date>2017-07-23</date>
        <change>Now using baseimage v2.0.2, which brings the following changes:</change>
        <change level="2">Proper VNC port is exposed.</change>
      </release>
      <release>
        <version>1.5.1</version>
        <date>2017-07-18</date>
        <change>Now using baseimage v2.0.1, which brings the following changes:</change>
        <change level="2">Internal enhancements.</change>
        <change level="2">Clean temporary files left by npm.</change>
      </release>
      <release>
        <version>1.5.0</version>
        <date>2017-07-17</date>
        <change>Now using baseimage v2.0.0, which brings the following changes:</change>
        <change level="2">Various internal enhancements.</change>
        <change level="2">Fixed the way a service waits for another one.</change>
      </release>
      <release>
        <version>1.4.0</version>
        <date>2017-07-04</date>
        <change>Now using baseimage v1.5.0, which brings the following changes:</change>
        <change level="2">Added the UMASK environment variable to control how file permissions are set for newly created files.</change>
        <change level="2">Added the X11VNC_EXTRA_OPTS environment variable used to pass additional arguments to the x11vnc server.</change>
        <change level="2">By default, activate auto-scaling of application's window.</change>
        <change level="2">Applied latest Alpine Linux security updates.</change>
      </release>
      <release>
        <version>1.3.1</version>
        <date>2017-06-22</date>
        <change>Now using baseimage v1.4.3, which brings the following changes:</change>
        <change level="2">Updated Alpine Linux to version 3.6.2.</change>
      </release>
      <release>
        <version>1.3.0</version>
        <date>2017-06-22</date>
        <change>Switched to Alpine Linux 3.6 baseimage.</change>
      </release>
      <release>
        <version>1.2.0</version>
        <date>2017-06-21</date>
        <change>Upgraded CloudBerry Backup to version 2.0.2.39.</change>
        <change>Now using baseimage v1.4.2, which brings the following changes (from last used version):</change>
        <change level="2">Associate the application's icon to a unique version to avoid browser cache issues.</change>
        <change level="2">Fixed prefix of some service related messages.</change>
        <change level="2">Added support for supplying supplementary groups of the application.</change>
        <change level="2">Improved process startup and shutdown.</change>
        <change level="2">When container is stopped or restarted, processes are now terminated gracefully and in proper order. This allow the GUI application to execute its termination routine.</change>
        <change level="2">No more error messages when container is stopped or restarted.</change>
      </release>
      <release>
        <version>1.1.2</version>
        <date>2017-05-30</date>
        <change>Now using baseimage v1.3.2, which brings the following changes:</change>
        <change level="2">Fixed password modal window not showing up when required.</change>
      </release>
      <release>
        <version>1.1.1</version>
        <date>2017-05-17</date>
        <change>Now using baseimage v1.3.1, which brings the following changes:</change>
        <change level="2">Better font is used.</change>
      </release>
      <release>
        <version>1.1.0</version>
        <date>2017-05-15</date>
        <change>Now using baseimage v1.3.0, which brings the following changes:</change>
        <change level="2">Added support for application's niceness configuration.</change>
      </release>
      <release>
        <version>1.0.3</version>
        <date>2017-05-12</date>
        <change>Now using baseimage v1.2.3, which brings the following changes:</change>
        <change level="2">Adjusted the default display width to 1280 pixels, as documented.</change>
      </release>
      <release>
        <version>1.0.2</version>
        <date>2017-05-11</date>
        <change>Now using baseimage v1.2.2, which brings the following changes:</change>
        <change level="2">Fixed issue with the web UI, where the remote application's window was not taking the available height after activating/deactivating the hideable navigation bar.</change>
      </release>
      <release>
        <version>1.0.1</version>
        <date>2017-05-10</date>
        <change>Now using baseimage v1.2.1, which brings the following changes:</change>
        <change level="2">Fixed issue where clipboard content was lost on modal window closure.</change>
      </release>
      <release>
        <version>1.0.0</version>
        <date>2017-05-09</date>
        <change>Initial release.</change>
      </release>
    </history>
  </app>
  <container>
    <!-- Environment variables -->
    <environment_variables>
      <environment_variable>
        <name>CBB_WEB_INTERFACE_USER</name>
        <description>Username to use to login to the CloudBerry Backup's web interface.</description>
        <default/>
        <unraid_template>
          <title>CloudBerry Backup Web Interface User</title>
          <display>advanced</display>
          <required>false</required>
          <mask>false</mask>
        </unraid_template>
      </environment_variable>
      <environment_variable>
        <name>CBB_WEB_INTERFACE_PASSWORD</name>
        <description>Password to use to login to the CloudBerry Backup's web interface.[br][span style='color: red;'][b]Warning:[/b][/span] See documentation for a more secure way to specify the password.</description>
        <default/>
        <unraid_template>
          <title>CloudBerry Backup Web Interface Password</title>
          <display>advanced</display>
          <required>false</required>
          <mask>true</mask>
        </unraid_template>
      </environment_variable>
    </environment_variables>
    <!-- Volumes -->
    <volumes>
      <volume>
        <container_path>/flash</container_path>
        <host_path_example/>
        <description/>
        <permissions>ro</permissions>
        <unraid_template>
          <title>Flash</title>
          <description>This is where data on your unRAID flash device is located.  Useful to backup your unRAID configuration.[br]Container path: /flash</description>
          <default>/boot</default>
          <display>always</display>
          <required>false</required>
          <mask>false</mask>
        </unraid_template>
      </volume>
    </volumes>
    <!-- Network ports -->
    <ports>
      <port>
        <number>43210</number>
        <protocol>tcp</protocol>
        <description>Port used to access the CloudBerry Backup's web interface via HTTP.</description>
        <mandatory>false</mandatory>
        <unraid_template>
          <title>CloudBerry Backup Web Interface HTTP Port</title>
          <default>43210</default>
          <display>advanced</display>
          <required>false</required>
          <mask>false</mask>
        </unraid_template>
      </port>
      <port>
        <number>43211</number>
        <protocol>tcp</protocol>
        <description>Port used to access the CloudBerry Backup's web interface via HTTPs.</description>
        <mandatory>false</mandatory>
        <unraid_template>
          <title>CloudBerry Backup Web Interface HTTPs Port</title>
          <default>43211</default>
          <display>advanced</display>
          <required>false</required>
          <mask>false</mask>
        </unraid_template>
      </port>
    </ports>
    <!-- Devices -->
    <devices/>
    <!-- Extra parameters -->
    <extra_params/>
  </container>
</defs>
